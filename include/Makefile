ALL_CTX=$(wildcard proof/Coq/*/*.ctx)
ALL_COQ=$(sort $(patsubst %.ctx,%.v,$(ALL_CTX)))

# Do not use cpp with -P switch to remove line directives generated by
# preprocessing, as this also removes blank lines that are needed by
# the Coq printer/parser in Why3 to recognize the VC. Use sed instead to
# remove lines that start with # symbol.
%.v: %.ctx
	cpp -w -I proof/Coq/common $< | sed -e 's/^#.*$$//g' > $@

clean:
	rm proof/Coq/*/*.v

generate: $(ALL_COQ)
