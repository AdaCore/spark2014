\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{url}
\usepackage{xspace}
\usepackage{hyperref}

\newcommand{\DO}{\textsc{do-178}\xspace}
\newcommand{\DOB}{\textsc{do-178b}\xspace}
\newcommand{\DOC}{\textsc{do-178c}\xspace}
\newcommand{\hilite}{Hi-Lite\xspace}
\newcommand{\gnatprove}{GNATprove\xspace}
\newcommand{\oldspark}{SPARK~2005\xspace}
\newcommand{\newspark}{SPARK~2014\xspace}
\newcommand{\spark}{SPARK\xspace}
\newcommand{\ada}{Ada\xspace}
\newcommand{\adatwtw}{Ada~2012\xspace}

\newcommand{\etc}{\textit{etc.}\xspace}
\newcommand{\ie}{\textit{i.e.,}\xspace}
\newcommand{\adhoc}{\textit{ad hoc}\xspace}
\newcommand{\Eg}{\textit{E.g.,}\xspace}
\newcommand{\eg}{\textit{e.g.,}\xspace}
\newcommand{\etal}{\textit{et al.}\xspace}
\newcommand{\wrt}{w.r.t.\xspace}
\newcommand{\aka}{a.k.a.\xspace}
\newcommand{\resp}{resp.\xspace}

\begin{document}

\title{Rail, Space, Security: Three Case Studies for SPARK 2014}

\author{Pavlos Efstathopoulos, David Lesens, David Mentr√© and Yannick Moy}

\date{}

\maketitle

\begin{abstract}
Insert your abstract here.
\end{abstract}

\section{Introduction}

\newspark is a major evolution of the SPARK language and toolset to address two
main hurdles previously identified in the take-up of formal verification
technology:
%
\begin{enumerate}
\item difficulty to reach non-expert users, and
\item lack of convincing cost-benefit argument.
\end{enumerate}

In this paper we will describe our approach to solve those two problems in the
design of the \newspark language and the associated formal verification tool
\gnatprove. We will use case studies from three different domains developed in
the context of the \hilite project and discuss the results of using our tools
on those case studies.

\section{SPARK 2014}

\subsection{SPARK: Past and Present}

SPARK is a programming language subset targeted at safety and security critical
applications. It is a subset of the Ada programming language, thus building on
the strengths of Ada for creating highly reliable and long-lived
software. SPARK restrictions ensure that the behavior of a SPARK program is
unambiguously defined, and simple enough that formal verification tools can
perform an automatic diagnostic of conformance between a program specification
and its implementation. The SPARK language and toolset for static verification
has been applied for many years in on-board aircraft systems, control systems,
cryptographic systems, and rail systems~\cite{sparkbook2012,oneill2012}.

SPARK evolution has followed the evolutions of Ada, with a new version of SPARK
for each new version of Ada: SPARK 83, SPARK 95, SPARK 2005, and now SPARK
2014. Up to the version \oldspark, the specification of the intended behavior
of a program was written in special comments, that were ignored by the usual
development tools (compiler, debugger), but interpreted by the formal
verification tools. The new version \newspark builds on the new specification
features added in \adatwtw, so formal specifications are now understood by the
usual development tools and can be executed.

\subsection{Key Features for Formal Verification}

\adatwtw introduced new language features for facilitating the specification of
programs~\cite{ada2012rationale}, many of which were inspired from the
corresponding features in \oldspark. The most useful of these new features is
without doubts the preconditions and postconditions (which together are
referred to as a contract) popularised by the Design-by-Contract
approach~\cite{meyer:1988:OSC}. \newspark is based on the features of \adatwtw,
to which it adds new ones, some of which inspired from \oldspark. We will
describe shortly in this subsection the key features defined in \newspark for
formal verification.

\subsection{Benefits of Executable Contracts}

Traditionally, contracts have been interpreted quite differently depending on
whether used for formal program verification or for run-time assertion
checking. For formal program verification, assertions have typically been
interpreted as formulae in classical first-order logic. This was the situation
with SPARK until version \oldspark. Practitioners have struggled with this
interpretation, which was not consistent with the run-time assertion checking
semantics.\cite{tseChalin10}

\newspark reconciles the logic semantics and executable semantics of contracts,
so users can now execute contracts, debug them like code, and test them when
formal verification is too difficult to achieve. Furthermore, there is an
advantage in keeping the annotation language the same, or almost the same, as
the programming language: users don't have to learn one more language.

\subsection{Integrating Testing and Formal Verification}

Formal methods are complementary to testing, and may find faults that
are not detected by testing, but they cannot establish verification
evidence for the target hardware. Therefore testing on the target is
still required. However, formal analysis of source code can be used to
show compliance with the low-level requirements. \DOC requires an
argument for property preservation between the source code and the
object code for those properties that have been verified formally at
the source level. Since formal program verification and testing are
complementary, we would like to use each method where it is most
efficient. For this we need to make sure that the combination is at
least as strong as testing alone.

\section{Train Control Systems}

% openETCS case study

The openETCS\footnote{\url{http://openetcs.org/}} European project
aims at making an open-sourced, open-proofs reference model of ETCS
(European Train Control System). ETCS is a radio-based train control
system aiming at unifying train signaling and control over all
European countries. Organized in several levels, ETCS can range from,
at Level 0, a simple ATP (Automatic Train Protection) system
monitoring train speed to, at Level 3, a fully featured radio-based
train control system where trains inform a Radio Block Centre about
their location and receives Movement Authorities, using cab signaling
instead of track-side signaling.

Within this framework we made some experiments with \newspark to see
if one could formalize the System Requirement Specification (ERA
UNISIG SUBSET-026). The first goal of this experiment was to check if
\newspark was expressive enough to describe the objects of the
requirements: requirement text, transition tables, breaking curve
equations, etc. The second goal was to play with proving capabilities
of \newspark, testing it on some parts of the specification in order
to evaluate them.

Before detailing our experiments, we should acknowledge that using
\newspark for formalizing \emph{system requirements} is a bit
excessive and out of scope for the language. We made nonetheless this
formalization for two reasons. Firstly we wanted to give a formal
semantics to this system specification and \newspark first-order logic
used for contract annotation should be suitable for this task. This
formalization would allow us to formally verify some properties at the
specification level.  Secondly, the ETCS' specifications are quite
low-level in some of its content, therefore not as far from \spark
language as one would have expected.

\subsection{Description of the Experiment}

Formalization of communication establishment?

Formalization of Mode transition table.

Formalization of Step functions.

\subsection{Formalization of Properties}

SRS excerpts and corresponding \newspark code.

\subsection{Formal Verification Results}

Possible to express most of requirements.

Not so much proofs (time consuming approach).

\subsection{Lessons Learned}

\newspark user defined types useful for contract clarity and helpful
for proofs.

Design code for proof (e.g. avoid early exit).

Verifiable contract is not always the ``natural'' contract.

Use feedback from the tool. Define a proof methodology.

\section{Flight Control and Vehicle Management in Space}

% Astrium case study

\subsection{Description of the Software}
\subsection{Formalization of Properties}
\subsection{Formal Verification Results}
\subsection{Lessons Learned}

\section{Biometric Access to a Secure Enclave}

% Tokeneer case study

\subsection{Initial Case Study}

Tokeneer is a highly secure biometric software system that was originally
developed by Altran in \oldspark. The system provides protection to secure
information held on a network of workstations situated in a physically
secure enclave. The Tokeneer project was commissioned by the US National
Security Agency (NSA) to demonstrate the feasibility of developing systems
to the level of rigour required by the higher assurance levels of the
Common Criteria. The development artefacts, including all source code,
are now publicly available. For more details see
\url{www.adacore.com/sparkpro/tokeneer}.

The core system consists of approximately 10,000 lines of \oldspark code
(declarations and executable lines, excluding blank lines, comments and
SPARK annotations). There are also approximately 3,700 lines of supporting
code written in Ada which mimicked the drivers to peripherals connected
to the core system. Achieving a full conversion of the entire code base
to \newspark and making the necessary changes to discharge all the VCs
with GNATprove is outside the scope of this study.

The source code of Tokeneer was proven to be free of runtime exceptions
and some key security properties were proven to hold but full functional
proof was not performed on the entirety of the code. This study will
focus on proving the biggest possible subset of the aforementioned
attributes using the \newspark toolset. Furthermore, partial flow analysis
will be attempted on a selected subset of files. Some additional aims of this
study are the following:
\begin {itemize}
  \item Evaluate how easy is it to convert programs from \oldspark to \newspark.
  \item Investigate how executable semantics affect the way code has to be written
        and what advantages/disadvantages they introduce.
  \item Discover the percentage of the code that can be automatically proven
        and the combination of options/provers that achieve the best results
        for this specific test case.
  \item Since \newspark is actively under development, providing feedback and
        suggesting features/changes that might improve the tools, is considered
        to be a side-benefit of this study.
\end {itemize}





\subsection{Description of the Software}
\subsection{Formalization of Properties}
\subsection{Formal Verification Results}
\subsection{Lessons Learned}

\section{Common Findings and Dissimilarities}

\section{Conclusion}

\bibliography{erts_2014}

\end{document}

% LocalWords:  openETCS ETCS UNISIG Centre SRS
