module App

  use import ref.Ref
  use import int.Int

  val g1 : ref int
  val g2 : ref int

  val g1_set_zero (x : unit) : unit
    requires { !g1 <> 0 }
    writes { g1}
    ensures { !g1 = 0 }

(* Unknown *)
  let test1 ()
    requires { true }
    ensures { !g1 = 0 }
    =
    g1_set_zero ()

(* Valid *)
  let test2 ()
    requires { !g1 <> 0 }
    ensures { !g1 = 0 }
    =
    g1_set_zero ()


  val set_zero (x : ref int) : unit
    requires { !x <> 0 }
    ensures { !x = 0 }
    writes {x}

(* Unknown *)
  let test3 ()
    requires { true }
    ensures { !g1 = 0 }
    =
    set_zero g1

(* Valid *)
  let test4 ()
    requires { !g1 <> 0 }
    ensures { !g1 = 0 }
    =
    set_zero g1

end
